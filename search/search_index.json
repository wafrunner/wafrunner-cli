{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to wafrunner-cli","text":"<p>This is the main documentation site for the <code>wafrunner-cli</code> project.</p> <p>This documentation contains non-code assets that are useful for project development, such as design files and reference materials. The contents are shared across the team but are not part of the application's build or distribution.</p> <p>To add more pages, create new <code>.md</code> files in this <code>docs/</code> directory and add them to the <code>nav</code> section of the <code>mkdocs.yml</code> file.</p>"},{"location":"reference/","title":"API Reference","text":""},{"location":"reference/#wafrunner-update","title":"wafrunner update","text":"<p>The <code>update</code> command downloads the latest CVE ID to vulnID lookup data and stores it in a local database.</p>"},{"location":"reference/#usage","title":"Usage","text":"<pre><code>wafrunner update\n</code></pre>"},{"location":"testing-guide/","title":"Testing Guide for wafrunner-cli","text":"<p>This guide documents the standard testing practices for this CLI application.</p>"},{"location":"testing-guide/#testing-stack","title":"Testing Stack","text":"<ul> <li>pytest: Primary testing framework</li> <li>typer.testing.CliRunner: For testing CLI commands</li> <li>flake8: Code linting</li> <li>black: Code formatting</li> <li>pre-commit: Git hooks for automated checks</li> </ul>"},{"location":"testing-guide/#test-types","title":"Test Types","text":""},{"location":"testing-guide/#1-unit-tests","title":"1. Unit Tests","text":"<p>Test individual functions and components in isolation.</p> <p>Location: <code>tests/test_*.py</code> Run: <code>pytest tests/</code> or <code>make test</code></p> <p>Example:</p> <pre><code>def test_api_client_initialization():\n    # Test specific functionality\n    pass\n</code></pre>"},{"location":"testing-guide/#2-cli-command-tests","title":"2. CLI Command Tests","text":"<p>Test that commands are properly registered and work correctly.</p> <p>Location: <code>tests/test_*_commands.py</code> Run: <code>pytest tests/ -k \"commands\"</code> or <code>make test-cli</code></p> <p>Example:</p> <pre><code>from typer.testing import CliRunner\nfrom wafrunner_cli.main import app\n\ndef test_command_success():\n    runner = CliRunner()\n    result = runner.invoke(app, [\"research\", \"github\", \"--id\", \"CVE-2024-1234\"])\n    assert result.exit_code == 0\n</code></pre>"},{"location":"testing-guide/#3-command-verification-tests","title":"3. Command Verification Tests","text":"<p>Ensures all required commands are present (prevents accidental removal).</p> <p>Location: <code>tests/test_command_verification.py</code> Run: <code>pytest tests/test_command_verification.py</code></p> <p>This test is critical - it verifies that no commands were accidentally removed during merges.</p>"},{"location":"testing-guide/#running-tests","title":"Running Tests","text":""},{"location":"testing-guide/#all-tests","title":"All Tests","text":"<pre><code>make test\n# or\npytest tests/\n</code></pre>"},{"location":"testing-guide/#unit-tests-only","title":"Unit Tests Only","text":"<pre><code>make test-unit\n# or\npytest tests/ -m \"not integration\"\n</code></pre>"},{"location":"testing-guide/#cli-tests-only","title":"CLI Tests Only","text":"<pre><code>make test-cli\n# or\npytest tests/ -k \"command\"\n</code></pre>"},{"location":"testing-guide/#with-coverage","title":"With Coverage","text":"<pre><code>pytest tests/ --cov=wafrunner_cli --cov-report=html\n</code></pre>"},{"location":"testing-guide/#pre-commit-hooks","title":"Pre-Commit Hooks","text":"<p>Pre-commit hooks automatically run before each commit:</p> <ol> <li>YAML validation</li> <li>End of file fixing</li> <li>Trailing whitespace removal</li> <li>Black formatting (auto-fixes)</li> <li>Flake8 linting</li> <li>Command verification (ensures all commands exist)</li> </ol> <p>To set up:</p> <pre><code>make install-dev\n</code></pre>"},{"location":"testing-guide/#code-quality-checks","title":"Code Quality Checks","text":""},{"location":"testing-guide/#linting","title":"Linting","text":"<pre><code>make lint\n# or\nflake8 wafrunner_cli tests scripts\n</code></pre>"},{"location":"testing-guide/#formatting","title":"Formatting","text":"<pre><code>make format\n# or\nblack wafrunner_cli tests scripts\n</code></pre>"},{"location":"testing-guide/#check-read-only","title":"Check (read-only)","text":"<pre><code>make check\n# Runs both lint and format checks without modifying files\n</code></pre>"},{"location":"testing-guide/#command-verification","title":"Command Verification","text":"<p>The command verification ensures all 8 required commands exist:</p> <pre><code>make verify-commands\n# or\n./scripts/verify-commands.sh\n# or\npytest tests/test_command_verification.py\n</code></pre> <p>Required commands:</p> <ul> <li><code>github</code></li> <li><code>scrape</code></li> <li><code>classify</code></li> <li><code>init-graph</code></li> <li><code>refine-graph</code> (critical - was accidentally removed before)</li> <li><code>init-scdef</code></li> <li><code>update-source</code></li> <li><code>links</code></li> </ul>"},{"location":"testing-guide/#best-practices","title":"Best Practices","text":""},{"location":"testing-guide/#1-test-structure","title":"1. Test Structure","text":"<ul> <li>Use <code>unittest.TestCase</code> or plain <code>pytest</code> functions</li> <li>Group related tests in classes</li> <li>Mock external dependencies (API calls, file system)</li> </ul>"},{"location":"testing-guide/#2-cli-testing","title":"2. CLI Testing","text":"<ul> <li>Always use <code>CliRunner</code> from <code>typer.testing</code></li> <li>Test both success and failure cases</li> <li>Verify exit codes and output messages</li> <li>Mock API clients to avoid real network calls</li> </ul>"},{"location":"testing-guide/#3-test-naming","title":"3. Test Naming","text":"<ul> <li>Files: <code>test_*.py</code></li> <li>Functions: <code>test_*</code></li> <li>Classes: <code>Test*</code></li> </ul>"},{"location":"testing-guide/#4-before-committing","title":"4. Before Committing","text":"<p>Always run:</p> <pre><code>make check        # Lint and format check\nmake test         # All tests\nmake verify-commands  # Command verification\n</code></pre> <p>Or let pre-commit hooks handle it automatically.</p>"},{"location":"testing-guide/#continuous-integration","title":"Continuous Integration","text":"<p>In CI/CD pipelines, run:</p> <pre><code># Install dependencies\npip install -e \".[test]\"\n\n# Run checks\nmake check\nmake verify-commands\n\n# Run tests\npytest tests/ --cov=wafrunner_cli --cov-report=xml\n</code></pre>"},{"location":"testing-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"testing-guide/#pre-commit-hooks-not-running","title":"Pre-commit hooks not running","text":"<pre><code>pre-commit install\n</code></pre>"},{"location":"testing-guide/#tests-failing-after-merge","title":"Tests failing after merge","text":"<pre><code># Check if commands are missing\nmake verify-commands\n\n# Check for import errors\npython -c \"from wafrunner_cli.main import app\"\n\n# Run specific test\npytest tests/test_specific.py -v\n</code></pre>"},{"location":"testing-guide/#command-not-found-in-tests","title":"Command not found in tests","text":"<pre><code># Verify command registration\npython -c \"from wafrunner_cli.commands.research import app; print([c.name for c in app.registered_commands])\"\n</code></pre>"},{"location":"testing-guide/#test-coverage-goals","title":"Test Coverage Goals","text":"<ul> <li>Aim for: &gt;80% coverage</li> <li>Critical paths: 100% coverage</li> <li>CLI commands: All commands should have tests</li> <li>Error handling: Test error paths</li> </ul>"},{"location":"testing-guide/#additional-resources","title":"Additional Resources","text":"<ul> <li>pytest documentation</li> <li>typer testing guide</li> <li>Pre-commit hooks</li> </ul>"},{"location":"usage/basic-commands/","title":"Basic Usage","text":"<p>This guide covers the basic commands to get started with <code>wafrunner-cli</code>.</p>"},{"location":"usage/basic-commands/#configuring-the-cli","title":"Configuring the CLI","text":"<p>Before you can use the tool, you need to set your API key. You can do this interactively:</p> <pre><code>wafrunner configure set-api-key\n</code></pre>"},{"location":"usage/basic-commands/#searching-for-data","title":"Searching for Data","text":"<p>To perform a basic search, use the <code>data search</code> command:</p> <pre><code>wafrunner data search \"log4j\" --limit 5\n</code></pre>"},{"location":"usage/collection-commands/","title":"Collection Commands","text":"<p>The <code>collection</code> command group provides tools for managing local collections of vulnerabilities.</p>"},{"location":"usage/collection-commands/#creating-a-new-collection","title":"Creating a New Collection","text":"<p>You can create a new collection of vulnerabilities using the <code>create</code> subcommand. This is useful for grouping related vulnerabilities for analysis or reporting.</p>"},{"location":"usage/collection-commands/#from-a-list-of-identifiers","title":"From a List of Identifiers","text":"<p>You can create a collection by providing a list of CVE IDs or vulnerability IDs directly on the command line:</p> <pre><code>wafrunner collection create my-first-collection --id CVE-2021-44228 --id a1ddadd4-1b9d-4fab-90fe-64c1c763cd58\n</code></pre>"},{"location":"usage/collection-commands/#from-a-file","title":"From a File","text":"<p>If you have a text file containing a list of identifiers (one per line), you can use the <code>--file</code> option:</p> <pre><code># my_ids.txt\nCVE-2021-44228\na1ddadd4-1b9d-4fab-90fe-64c1c763cd58\n\nwafrunner collection create my-second-collection --file my_ids.txt\n</code></pre>"},{"location":"usage/collection-commands/#listing-collections","title":"Listing Collections","text":"<p>To see all of your local collections, use the <code>list</code> subcommand:</p> <pre><code>wafrunner collection list\n</code></pre>"},{"location":"usage/collection-commands/#showing-a-collection","title":"Showing a Collection","text":"<p>To view the contents of a specific collection, use the <code>show</code> subcommand:</p> <pre><code>wafrunner collection show my-first-collection\n</code></pre>"},{"location":"usage/collection-commands/#deleting-a-collection","title":"Deleting a Collection","text":"<p>To remove a collection, use the <code>delete</code> subcommand:</p> <pre><code>wafrunner collection delete my-first-collection\n</code></pre>"},{"location":"usage/configure-cli/","title":"Configuring the CLI","text":"<p>The <code>configure</code> command group allows you to manage the settings for <code>wafrunner-cli</code>.</p>"},{"location":"usage/configure-cli/#setting-your-api-key","title":"Setting Your API Key","text":"<p>The most important configuration is setting your API key, which is required to authenticate with the wafrunner platform.</p>"},{"location":"usage/configure-cli/#interactive-prompt","title":"Interactive Prompt","text":"<p>The easiest way to set your key is to run the command without any arguments. You will be prompted to enter your key securely:</p> <pre><code>wafrunner configure set-api-key\n</code></pre> <p>The CLI will hide your input for security.</p>"},{"location":"usage/configure-cli/#non-interactive-via-option","title":"Non-Interactive (via Option)","text":"<p>You can also provide the key directly as an option. This is useful for scripting and automated environments.</p> <pre><code>wafrunner configure set-api-key --api-key YOUR_SECRET_API_KEY\n</code></pre>"},{"location":"usage/cve-commands/","title":"CVE Commands","text":"<p>The <code>cve</code> command group allows you to retrieve detailed information about specific Common Vulnerabilities and Exposures (CVEs).</p>"},{"location":"usage/cve-commands/#get-cve-details","title":"Get CVE Details","text":"<p>You can fetch comprehensive details for a given CVE ID using the <code>get</code> subcommand.</p>"},{"location":"usage/cve-commands/#by-cve-id","title":"By CVE ID","text":"<p>Provide the full CVE ID as an argument to retrieve its information:</p> <pre><code>wafrunner cve get CVE-2021-44228\n</code></pre> <p>This command will return a detailed JSON response containing all available information for the specified CVE.</p>"},{"location":"usage/cve-commands/#example-output","title":"Example Output","text":"<pre><code>{\n  \"cveId\": \"CVE-2021-44228\",\n  \"description\": \"Apache Log4j2 JNDI features...\",\n  \"severity\": \"CRITICAL\",\n  \"publishedDate\": \"2021-12-10T00:00:00Z\",\n  \"references\": [\n    \"https://nvd.nist.gov/vuln/detail/CVE-2021-44228\"\n  ]\n}\n</code></pre>"},{"location":"usage/cve-commands/#lookup-cve-and-vulnerability-ids","title":"Lookup CVE and Vulnerability IDs","text":"<p>You can use the <code>lookup</code> command to find the corresponding CVE ID for a vulnerability ID, or vice-versa.</p>"},{"location":"usage/cve-commands/#usage","title":"Usage","text":"<pre><code>wafrunner cve lookup &lt;IDENTIFIER&gt;\n</code></pre> <p>Replace <code>&lt;IDENTIFIER&gt;</code> with either a CVE ID or a vulnerability ID.</p>"},{"location":"usage/cve-commands/#example","title":"Example","text":"<pre><code>$ wafrunner cve lookup CVE-2024-21710\n{\n  \"cve_id\": \"CVE-2024-21710\",\n  \"vuln_id\": \"a1ddadd4-1b9d-4fab-90fe-64c1c763cd58\"\n}\n\n$ wafrunner cve lookup a1ddadd4-1b9d-4fab-90fe-64c1c763cd58\n{\n  \"cve_id\": \"CVE-2024-21710\",\n  \"vuln_id\": \"a1ddadd4-1b9d-4fab-90fe-64c1c763cd58\"\n}\n</code></pre>"},{"location":"usage/data-commands/","title":"Interacting with Data","text":"<p>The <code>data</code> command group provides tools for searching and retrieving data from the wafrunner platform.</p>"},{"location":"usage/data-commands/#searching-for-data","title":"Searching for Data","text":"<p>You can perform a free-text search across various data sources using the <code>search</code> command.</p>"},{"location":"usage/data-commands/#basic-search","title":"Basic Search","text":"<p>To run a search, provide a query string as an argument. By default, the search will return up to 10 results.</p> <pre><code>wafrunner data search \"log4j exploit\"\n</code></pre>"},{"location":"usage/data-commands/#limiting-results","title":"Limiting Results","text":"<p>You can control the number of results returned by using the <code>--limit</code> or <code>-l</code> option:</p> <pre><code>wafrunner data search \"ProxyLogon\" --limit 25\n</code></pre>"},{"location":"usage/research-commands/","title":"Research Commands","text":"<p>The <code>research</code> command group helps you initiate research tasks against vulnerability identifiers.</p>"},{"location":"usage/research-commands/#github-repository-search","title":"GitHub Repository Search","text":"<p>You can trigger a search for public GitHub repositories related to a specific vulnerability.</p>"},{"location":"usage/research-commands/#by-single-identifier","title":"By Single Identifier","text":"<p>To search for a single vulnerability, provide either a CVE ID or a vulnerability ID using the <code>--id</code> option:</p> <pre><code>wafrunner research github --id CVE-2021-44228\n</code></pre> <pre><code>wafrunner research github --id a1ddadd4-1b9d-4fab-90fe-64c1c763cd58\n</code></pre>"},{"location":"usage/research-commands/#from-a-collection","title":"From a Collection","text":"<p>If you have a collection of vulnerability identifiers, you can process them in bulk:</p> <pre><code>wafrunner research github --collection my-collection\n</code></pre> <p>The tool requires that you provide either <code>--id</code> or <code>--collection</code>, but not both.</p>"},{"location":"usage/research-commands/#scrape-data-sources","title":"Scrape Data Sources","text":"<p>You can also trigger a scrape of all data sources associated with a vulnerability:</p> <pre><code>wafrunner research scrape --id CVE-2021-44228\n</code></pre> <p>This command will fetch all related links and initiate a data scrape for each one.</p>"},{"location":"usage/research-commands/#scdef-initialization","title":"SCDEF Initialization","text":"<p>You can trigger SCDEF (Security Control Definition) initialization for vulnerabilities:</p>"},{"location":"usage/research-commands/#by-single-identifier_1","title":"By Single Identifier","text":"<pre><code>wafrunner research init-scdef --id CVE-2021-44228\n</code></pre>"},{"location":"usage/research-commands/#with-custom-graph-id","title":"With Custom Graph ID","text":"<pre><code>wafrunner research init-scdef --id CVE-2021-44228 --graph my-graph-id\n</code></pre>"},{"location":"usage/research-commands/#from-a-collection_1","title":"From a Collection","text":"<pre><code>wafrunner research init-scdef --collection my-collection\n</code></pre> <p>The command supports:</p> <ul> <li><code>--graph/-g</code>: Specify a custom graph ID (optional, defaults to API-selected graph)</li> <li><code>--max-workers/-t</code>: Number of worker threads (default: 4, auto-scales to 8 for collections with 30+ items)</li> <li><code>--verbose/-V</code>: Show detailed logging</li> <li><code>--log-dir</code>: Custom log directory (default: <code>./run_logs</code>)</li> </ul> <p>The tool requires that you provide either <code>--id</code> or <code>--collection</code>, but not both.</p>"}]}